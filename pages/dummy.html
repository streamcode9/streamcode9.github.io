---
layout: page
title: Dummy Page
permalink: /dummy/
---
<section class="dummy-page">
  <h2>Dummy Content</h2>
  <p>This is a placeholder page created for testing purposes. Feel free to update this content with real information later.</p>
  <ul>
    <li>Item one</li>
    <li>Item two</li>
    <li>Item three</li>
  </ul>
  <blockquote>
    <p>"Sometimes you just need a blank canvas before the masterpiece arrives."</p>
  </blockquote>
</section>

<section class="dummy-page">
  <h2>WebAssembly Greeting Demo</h2>
  <p>
    The button below loads <code>wasm/hello.wasm</code>—a module compiled from <code>hello.c</code>—
    and calls the exported <code>get_greeting</code> function to display its message.
  </p>
  <button type="button" id="load-wasm">Load greeting from WebAssembly</button>
  <pre id="wasm-result" aria-live="polite">Click the button to fetch the WebAssembly module.</pre>
</section>

<script type="module">
const wasmUrl = '/wasm/hello.wasm';
const loadButton = document.getElementById('load-wasm');
const output = document.getElementById('wasm-result');
const utf8Decoder = new TextDecoder('utf-8');

function createWasiImports() {
  const noop = () => 0;

  return {
    wasi_snapshot_preview1: {
      proc_exit(code) {
        if (code !== 0) {
          throw new Error(`WebAssembly module exited with code ${code}`);
        }
      },
      fd_close: noop,
      fd_fdstat_get: noop,
      fd_seek: noop,
      fd_write: noop,
      environ_get: noop,
      environ_sizes_get: noop,
      args_get: noop,
      args_sizes_get: noop,
      clock_time_get: noop,
      random_get: noop,
    },
  };
}

async function loadGreetingFromWasm() {
  output.textContent = 'Loading greeting...';

  try {
    const response = await fetch(wasmUrl);
    if (!response.ok) {
      throw new Error(`Unexpected response: ${response.status} ${response.statusText}`);
    }

    const buffer = await response.arrayBuffer();
    const imports = createWasiImports();
    const { instance } = await WebAssembly.instantiate(buffer, imports);
    const { exports } = instance;

    const getGreeting = exports.get_greeting || exports._get_greeting;
    const getGreetingLength = exports.get_greeting_length || exports._get_greeting_length;

    if (typeof getGreeting !== 'function' || typeof getGreetingLength !== 'function') {
      throw new Error('Expected WebAssembly exports were not found.');
    }

    if (typeof exports._initialize === 'function') {
      exports._initialize();
    }

    const memory = exports.memory;

    if (!(memory instanceof WebAssembly.Memory)) {
      throw new Error('WebAssembly memory export is missing.');
    }

    const pointer = getGreeting();
    const length = getGreetingLength();
    const bytes = new Uint8Array(memory.buffer, pointer, length);
    const greeting = utf8Decoder.decode(bytes);

    output.textContent = greeting;
  } catch (error) {
    console.error('Failed to load WebAssembly module:', error);
    output.textContent = `Failed to load greeting: ${error.message}`;
  }
}

loadButton.addEventListener('click', loadGreetingFromWasm);
</script>
