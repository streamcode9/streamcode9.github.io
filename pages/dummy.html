<button type="button" id="load-wasm">Load greeting from WebAssembly</button>
<pre id="wasm-result" aria-live="polite">Click the button to fetch the WebAssembly module.</pre>

<script type="module">
const wasmPath = '/wasm/hello.wasm'; // relative (works on GitHub Pages subpaths)
const loadButton = document.getElementById('load-wasm');
const output = document.getElementById('wasm-result');
const utf8 = new TextDecoder();

async function loadGreetingFromWasm() {
  output.textContent = 'Loading greeting...';

  const res = await fetch(new URL(wasmPath, document.baseURI));  
  const { instance: { exports } } = await WebAssembly.instantiateStreaming(res, {});
  if (typeof exports._initialize === 'function') exports._initialize();
  
  const ptr = exports.get_greeting();
  const len = exports.get_greeting_length();
  const bytes = new Uint8Array(exports.memory.buffer, ptr, len);

  output.textContent = utf8.decode(bytes);
}

loadButton?.addEventListener('click', loadGreetingFromWasm);
</script>
